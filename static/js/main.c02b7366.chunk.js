(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{26:function(e,t,n){e.exports=n(41)},31:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(21),l=n.n(r),c=(n(31),n(25)),i=n(24),s=n(12),u=n(6),d=n(7),h=n(10),f=n(8),m=n(11),b=n(5),p=n(9),v=n(15),k="https://reactnd-books-api.udacity.com",E=localStorage.token;E||(E=localStorage.token=Math.random().toString(36).substr(-8));var y={Accept:"application/json",Authorization:E},g=function(e){return fetch("".concat(k,"/books/").concat(e),{headers:y}).then(function(e){return e.json()}).then(function(e){return e.book})},S=function(){return fetch("".concat(k,"/books"),{headers:y}).then(function(e){return e.json()}).then(function(e){return e.books})},j=function(e,t){return fetch("".concat(k,"/books/").concat(e.id),{method:"PUT",headers:Object(v.a)({},y,{"Content-Type":"application/json"}),body:JSON.stringify({shelf:t})}).then(function(e){return e.json()})},R=function(e){return fetch("".concat(k,"/search"),{method:"POST",headers:Object(v.a)({},y,{"Content-Type":"application/json"}),body:JSON.stringify({query:e})}).then(function(e){return e.json()}).then(function(e){return e.books})};var N=function(e){var t=e.thumbnailURL;return o.a.createElement("div",{className:"book-cover",style:{width:128,height:193,backgroundImage:"url('".concat(t,"')")}})};var O=function(e){return o.a.createElement("div",{className:"book-shelf-changer"},o.a.createElement("select",{defaultValue:e.shelf,onChange:function(t){var n=e.id,a=e.shelf;(0,e.onUpdateShelfHandler)({id:n},a,t.target.value)}},o.a.createElement("option",{disabled:!0},"Move to..."),o.a.createElement("option",{value:""}),o.a.createElement("option",{value:"currentlyReading"},"Currently Reading"),o.a.createElement("option",{value:"wantToRead"},"Want to Read"),o.a.createElement("option",{value:"read"},"Read"),o.a.createElement("option",{value:"none"},"None")))};var w=function(e){var t=e.title,n=e.authors;return o.a.createElement("div",null,o.a.createElement("div",{className:"book-title"},t),o.a.createElement("div",{className:"book-authors"},n&&n.length>0?n.join(", "):"Unknown Author"))};var B=function(e){var t=e.book,n=e.onUpdateShelfHandle,a=t.authors,r=t.id,l=t.imageLinks,c=t.shelf,i=t.title,s=(l||{thumbnail:"https://d2ofpir5gh0cbr.cloudfront.net/files/2017-11/carousel-01.jpg"}).thumbnail;return o.a.createElement("div",{className:"book"},o.a.createElement("div",{className:"book-top"},o.a.createElement(N,{thumbnailURL:s}),o.a.createElement(O,{id:r,shelf:c,onUpdateShelfHandler:function(e,t,a){return n(e,t,a)}})),o.a.createElement(w,{authors:a,title:i}))};var U=function(e){var t=e.books,n=e.name,a=e.onUpdateShelf,r=function(e,t,n){return a(e,t,n)};return o.a.createElement("div",{className:"bookshelf"},o.a.createElement("h2",{className:"bookshelf-title"},n),o.a.createElement("div",{className:"bookshelf-books"},o.a.createElement("ol",{className:"books-grid"},t.length>0&&t.map(function(e){return o.a.createElement("li",{key:e.id},o.a.createElement(B,{book:e,onUpdateShelfHandle:r}))}))))},T=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(h.a)(this,Object(f.a)(t).call(this,e))).updateQuery=function(e){var t=e.target.value;n.setState({inputValue:t}),n.props.searchHandler(t)},n.state={inputValue:""},n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"search-books-bar"},o.a.createElement(p.b,{to:"/",className:"close-search"},"Go Home"),o.a.createElement("div",{className:"search-books-input-wrapper"},o.a.createElement("input",{placeholder:"Search Books",value:this.state.inputValue,type:"text",onChange:this.updateQuery})))}}]),t}(a.Component),H=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(h.a)(this,Object(f.a)(t).call(this,e))).handleQuery=function(e){if(""!==e){var a=n.props.existingBooks;R(e.trim()).then(function(e){if(e.error)n.setState({error:!0});else{var o=t.shelfizedBooks(e,a);n.setState(function(e){return{searchedBooks:o,error:!e.error&&e.error}})}})}},n.shelfHandler=function(e,t,a){(0,n.props.onUpdateShelf)(e,t,a)},n.state={searchedBooks:[],error:!1},n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,n=this.props.existingBooks,a=this.state,r=a.searchedBooks,l=a.error,c=t.shelfizedBooks(r,n);return o.a.createElement("div",{className:"search-books"},o.a.createElement(T,{searchHandler:this.handleQuery}),l?o.a.createElement("div",{className:"search-books-results"},o.a.createElement("h2",{className:"bookshelf-title",style:{textAlign:"center",color:"red"}},"No relevant books found")):o.a.createElement("div",{className:"search-books-results"},o.a.createElement("ol",{className:"books-grid"},c.length>0&&c.map(function(t){return o.a.createElement("li",{key:t.id},o.a.createElement(B,{book:t,onUpdateShelfHandle:e.shelfHandler}))}))))}}]),t}(a.Component);H.shelfizedBooks=function(e,t){var n=[],a=!0,o=!1,r=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var i=l.value,s=!1,u=!0,d=!1,h=void 0;try{for(var f,m=t[Symbol.iterator]();!(u=(f=m.next()).done);u=!0){var b=f.value;if(i.id===b.id){i.shelf=b.shelf,s=!0;break}}}catch(p){d=!0,h=p}finally{try{u||null==m.return||m.return()}finally{if(d)throw h}}s||(i.shelf="none"),n.push(i)}}catch(p){o=!0,r=p}finally{try{a||null==c.return||c.return()}finally{if(o)throw r}}return n};var x=H,C=(n(40),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(h.a)(this,Object(f.a)(t).call(this,e))).fetchBooks=function(){S().then(function(e){var a=t.categorizeBooks(e),o=a.currentlyReading,r=a.wantToRead,l=a.read;n.setState({books:e,currentlyReading:o,wantToRead:r,read:l})})},n.updateShelfLocal=function(e,t,a){if("none"===a)n.setState(function(n){return Object(s.a)({},t,n[t].filter(function(t){return t.id!==e.id}))});else{var o=n.state[t].filter(function(t){return t.id===e.id}),r=Object(i.a)(o,1)[0];r.shelf=a,n.setState(function(n){var o;return o={},Object(s.a)(o,a,[].concat(Object(c.a)(n[a]),[r])),Object(s.a)(o,t,n[t].filter(function(t){return t.id!==e.id})),o})}n.updateShelfOnly(e,a)},n.updateShelfOnly=function(e,t){j(e,t).then(function(e){return console.log(e)})},n.updateShelfRemote=function(e,a,o){n.updateShelfOnly(e,o),g(e.id).then(function(a){a.shelf=o,n.setState(function(n){var o=n.books.filter(function(t){return t.id!==e.id}).concat(a),r=t.categorizeBooks(o);return{books:o,currentlyReading:r.currentlyReading,wantToRead:r.wantToRead,read:r.read}})})},n.state={books:[],currentlyReading:[],read:[],wantToRead:[]},n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.fetchBooks()}},{key:"render",value:function(){var e=this,t=this.state,n=t.books,a=t.currentlyReading,r=t.wantToRead,l=t.read;return o.a.createElement("div",{className:"App"},o.a.createElement(b.a,{exact:!0,path:"/",render:function(){return o.a.createElement("div",{className:"list-books"},o.a.createElement("div",{className:"list-books-title"},o.a.createElement("h1",null,"MyReads")),o.a.createElement("div",{className:"list-books-content"},o.a.createElement("div",null,o.a.createElement(U,{books:a,name:"Currently Reading",onUpdateShelf:e.updateShelfLocal}),o.a.createElement(U,{books:r,name:"Want to Read",onUpdateShelf:e.updateShelfLocal}),o.a.createElement(U,{books:l,name:"Read",onUpdateShelf:e.updateShelfLocal}))),o.a.createElement("div",{className:"open-search"},o.a.createElement(p.b,{className:"open-search",to:"/search"},o.a.createElement("button",null,"Add Book"))))}}),o.a.createElement(b.a,{path:"/search",render:function(){return o.a.createElement(x,{onUpdateShelf:e.updateShelfRemote,existingBooks:n})}}))}}]),t}(a.Component));C.categorizeBooks=function(e){return{currentlyReading:e.filter(function(e){return"currentlyReading"===e.shelf}),wantToRead:e.filter(function(e){return"wantToRead"===e.shelf}),read:e.filter(function(e){return"read"===e.shelf})}};var z=C;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(o.a.createElement(p.a,null," ",o.a.createElement(z,null)," "),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[26,1,2]]]);
//# sourceMappingURL=main.c02b7366.chunk.js.map